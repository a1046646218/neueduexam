<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

	<head>

		<!-- Basic -->
		<meta charset="UTF-8" />

		<title>学生home</title>

		<!-- Mobile Metas -->
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

		<!-- Import google fonts -->
		<!-- <link href='http://fonts.useso.com/css?family=Titillium+Web' rel='stylesheet' type='text/css'> -->

		<!-- Favicon and touch icons -->
		<link rel="shortcut icon" th:href="@{static/assets/ico/favicon.ico}" type="image/x-icon" />
		<link rel="apple-touch-icon" th:href="@{static/assets/ico/apple-touch-icon.png}" />
		<link rel="apple-touch-icon" sizes="57x57" th:href="@{static/assets/ico/apple-touch-icon-57x57.png}" />
		<link rel="apple-touch-icon" sizes="72x72" th:href="@{static/assets/ico/apple-touch-icon-72x72.png}" />
		<link rel="apple-touch-icon" sizes="76x76" th:href="@{static/assets/ico/apple-touch-icon-76x76.png}" />
		<link rel="apple-touch-icon" sizes="114x114" th:href="@{static/assets/ico/apple-touch-icon-114x114.png}" />
		<link rel="apple-touch-icon" sizes="120x120" th:href="@{static/assets/ico/apple-touch-icon-120x120.png}" />
		<link rel="apple-touch-icon" sizes="144x144" th:href="@{static/assets/ico/apple-touch-icon-144x144.png}" />
		<link rel="apple-touch-icon" sizes="152x152" th:href="@{static/assets/ico/apple-touch-icon-152x152.png}" />

		<!-- start: CSS file-->

		<!-- Vendor CSS-->
		<link th:href="@{static/assets/vendor/bootstrap/css/bootstrap.min.css}" rel="stylesheet" />
		<link th:href="@{static/assets/vendor/skycons/css/skycons.css}" rel="stylesheet" />
		<link th:href="@{static/assets/vendor/font-awesome/css/font-awesome.min.css}" rel="stylesheet" />
		<link th:href="@{static/assets/vendor/css/pace.preloader.css}" rel="stylesheet" />

		<!-- Plugins CSS-->
		<link th:href="@{static/assets/plugins/bootkit/css/bootkit.css}" rel="stylesheet" />

		<!-- Theme CSS -->
		<link th:href="@{static/assets/css/jquery.mmenu.css}" rel="stylesheet" />

		<!-- Page CSS -->
		<link th:href="@{static/assets/css/style.css}" rel="stylesheet" />
		<link th:href="@{static/assets/css/add-ons.min.css}" rel="stylesheet" />

		<!-- end: CSS file-->

		<!-- Head Libs -->
		<script th:src="@{static/assets/plugins/modernizr/js/modernizr.js}"></script>
		<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		<!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
			<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->

	</head>

	<body>



		<!-- Start: Header -->
		<div class="navbar" role="navigation">
		</div>
		<!-- End: Header -->

		<!-- Start: Content -->
		<div class="container-fluid content">
			<div class="row">

				<!-- Sidebar -->
				<div class="sidebar">
					<div class="sidebar-collapse">
						<!-- Sidebar Header Logo-->
						<div class="sidebar-header">
							<img th:src="@{static/assets/img/logo.png}" class="img-responsive" alt="" />
						</div>
						<!-- Sidebar Menu-->
						<div class="sidebar-menu">
							<nav id="menu" class="nav-main" role="navigation">
								<ul class="nav nav-sidebar">
									<li>
										<a href="admin1">
											<i class="fa fa-laptop" aria-hidden="true"></i><span>数据分析</span>
										</a>
									</li>
									<li>
										<a href="toCheckIllegalQuestion">
											<!-- <span class="pull-right label label-danger">235</span> -->
											<i class="fa fa-folder-o" aria-hidden="true"></i><span>敏感词分析</span>
										</a>
									</li>
									<li>
										<a href="toGuanLiYuan">
											<!-- <span class="pull-right label label-danger">235</span> -->
											<i class="fa fa-folder-o" aria-hidden="true"></i><span>用户管理</span>
										</a>
									</li>
									<li>
										<a href="toadmin11">
											<!-- <span class="pull-right label label-danger">235</span> -->
											<i class="fa fa-folder-o" aria-hidden="true"></i><span>题库查重</span>
										</a>
									</li>
								</ul>
							</nav>
						</div>
						<!-- End Sidebar Menu-->
					</div>
					<!-- Sidebar Footer-->
					<div class="sidebar-footer">
						<div class="small-chart-visits">
							<div class="small-chart" id="sparklineLineVisits"></div>
							<div class="small-chart-info">
								<label>New Visits</label>
								<strong>70,79%</strong>
							</div>
							<script type="text/javascript">
								var sparklineLineVisitsData = [15, 16, 17, 19, 15, 25, 23, 35, 29, 15, 30, 45];
							</script>
						</div>
						<ul class="sidebar-terms bk-margin-top-10">
							<li>
								<a href="#">Terms</a>
							</li>
							<li>
								<a href="#">Privacy</a>
							</li>
							<li>
								<a href="#">Help</a>
							</li>
							<li>
								<a href="#">About</a>
							</li>
						</ul>
					</div>
					<!-- End Sidebar Footer-->
				</div>
				<!-- End Sidebar -->

				<!-- Main Page -->
				<div class="main ">
					<div class="row">
						<div class="col-lg-5 col-md-5 col-sm-5 col-xs-12">
							<div class="panel panel-default bk-bg-white" style="height:350px;" id="checkinchart">

							</div>
						</div>
						<div class="col-lg-7 col-md-7 col-sm-7 col-xs-12">
							<div class="panel panel-default bk-bg-white" style="height:350px;" id="echart2">

							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-lg-8 col-md-8 col-sm-8 col-xs-12">
							<div class="panel panel-default bk-bg-white" style="height:350px;" id="questioneasychart">

							</div>
						</div>
						<div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
							<div class="panel panel-default bk-bg-white" style="height:350px;" id="errorcharts">

							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
							<div class="panel panel-default bk-bg-white" style="height:400px;" id="nowcost">

							</div>
						</div>
					</div>
				</div>
				<!-- End Main Page -->

				<!-- Footer -->

				<!-- End Footer -->

			</div>
		</div>
		<!-- Vendor JS-->
		<script th:src="@{static/assets/vendor/js/jquery.min.js}"></script>
		<script th:src="@{static/assets/vendor/js/jquery-2.1.1.min.js}"></script>
		<script th:src="@{static/assets/vendor/js/jquery-migrate-1.2.1.min.js}"></script>
		<script th:src="@{static/assets/vendor/bootstrap/js/bootstrap.min.js}"></script>
		<script th:src="@{static/assets/vendor/skycons/js/skycons.js}"></script>
		<script th:src="@{static/assets/vendor/js/pace.min.js}"></script>

		<!-- Plugins JS-->
		<!-- <script src="http://maps.google.com/maps/api/js?sensor=false"></script> -->
		<!-- <script th:src="@{static/assets/plugins/gmaps/gmaps.js}"></script> -->
		<script th:src="@{static/assets/plugins/sparkline/js/jquery.sparkline.min.js}"></script>

		<!-- Theme JS -->
		<script th:src="@{static/assets/js/jquery.mmenu.min.js}"></script>
		<script th:src="@{static/assets/js/core.min.js}"></script>

		<!-- Pages JS -->
		<!-- <script th:src="@{static/assets/js/pages/map-basic.js}"></script> -->
		<script th:src="@{static/layer/layer.js}"></script>
		<script th:src="@{static/js/echarts.min.js}"></script>
		<!-- end: JavaScript-->



	</body>
	<script type="application/javascript">
		function adderrorexam(result) {
			var myChart = echarts.init(document.getElementById("errorcharts"));
			option = {
				angleAxis: {
					type: 'category',
					data: ['单选题', '多选题', '判断题', '填空题', '简答题'],
					z: 10
				},
				radiusAxis: {},
				polar: {},
				toolbox: {
					show: true,
					feature: {
						mark: {
							show: true
						},
						dataView: {
							show: true,
							readOnly: false
						},
						magicType: {
							show: true,
							type: ['pie', 'funnel']
						},
						restore: {
							show: true
						},
						saveAsImage: {
							show: true
						}
					}
				},
				series: [{
					type: 'bar',
					data: [result[5], result[6], result[7], result[8], result[9]],
					coordinateSystem: 'polar',
					name: '对',
					stack: 'a'
				}, {
					type: 'bar',
					data: [result[0] - result[5], result[1] - result[6], result[2] - result[7], result[3] - result[8], result[4] -
						result[9]
					],
					coordinateSystem: 'polar',
					name: '全',
					stack: 'a'
				}],
				legend: {
					show: true,
					data: ['对', '全']
				}
			};
			myChart.setOption(option);
		}


		function adddatachart(result) {
			var myChart = echarts.init(document.getElementById("echart2"));
			option = {
				title: {
					text: '邀请码时间段数量',
					subtext: '比较'
				},
				tooltip: {
					trigger: 'axis'
				},
				legend: {
					data: ['每日数量']
				},
				toolbox: {
					show: true,
					feature: {
						dataZoom: {
							yAxisIndex: 'none'
						},
						dataView: {
							readOnly: false
						},
						magicType: {
							type: ['line', 'bar']
						},
						restore: {},
						saveAsImage: {}
					}
				},
				xAxis: {
					type: 'category',
					boundaryGap: false,
					data: ['前一天', '前二天', '前三天', '前四天', '前五天', '前六天', '前七天']
				},
				yAxis: {
					type: 'value',
					axisLabel: {
						formatter: '{value} °C'
					}
				},
				series: [{
						name: '本周',
						type: 'line',
						data: [result.now[0], result.now[1], result.now[2], result.now[3], result.now[4], result.now[5], result.now[6]],
						markPoint: {
							data: [{
									type: 'max',
									name: '最大值'
								},
								{
									type: 'min',
									name: '最小值'
								}
							]
						},
						markLine: {
							data: [{
								type: 'average',
								name: '平均值'
							}]
						}
					},
					{
						name: '上周',
						type: 'line',
						data: [result.before[0], result.before[1], result.before[2], result.before[3], result.before[4], result.before[
							5], result.before[6]],
						markPoint: {
							data: [{
								name: '周最低',
								value: -2,
								xAxis: 1,
								yAxis: -1.5
							}]
						},
						markLine: {
							data: [{
									type: 'average',
									name: '平均值'
								},
								[{
									symbol: 'none',
									x: '90%',
									yAxis: 'max'
								}, {
									symbol: 'circle',
									label: {
										normal: {
											position: 'start',
											formatter: '最大值'
										}
									},
									type: 'max',
									name: '最高点'
								}]
							]
						}
					}
				]
			};
			myChart.setOption(option);
		}

		function addcheckinchart(result) {
			var myChart = echarts.init(document.getElementById("checkinchart"));
			var xAxisData = ['前一天', '前二天', '前三天', '前四天', '前五天', '前六天', '前七天'];
			var data1 = [result.now[0], result.now[1], result.now[2], result.now[3], result.now[4], result.now[5], result.now[6]];
			var data2 = [result.before[0], result.before[1], result.before[2], result.before[3], result.before[4], result.before[
				5], result.before[6]];
			option = {
				title: {
					text: '本周与上周收入对比'
				},
				legend: {
					data: ['本周', '上周'],
					align: 'left'
				},
				toolbox: {
					feature: {
						magicType: {
							type: ['stack', 'tiled']
						},
						dataView: {},
						saveAsImage: {
							pixelRatio: 2
						}
					}
				},
				tooltip: {},
				xAxis: {
					data: xAxisData,
					silent: false,
					splitLine: {
						show: false
					}
				},
				yAxis: {},
				series: [{
					name: '本周',
					type: 'bar',
					data: data1,
					animationDelay: function(idx) {
						return idx * 10;
					}
				}, {
					name: '上周',
					type: 'bar',
					data: data2,
					animationDelay: function(idx) {
						return idx * 10 + 100;
					}
				}],
				animationEasing: 'elasticOut',
				animationDelayUpdate: function(idx) {
					return idx * 5;
				}
			};
			myChart.setOption(option);

		}

		function addeasy(result) {
			var myChart = echarts.init(document.getElementById("questioneasychart"));
			option = {
				title: {
					text: '题目与难易程度统计'
				},
				toolbox: {
					feature: {
						magicType: {
							type: ['stack', 'tiled']
						},
						dataView: {},
						saveAsImage: {
							pixelRatio: 2
						}
					}
				},
				tooltip: {
					trigger: 'axis',
					axisPointer: { // 坐标轴指示器，坐标轴触发有效
						type: 'shadow' // 默认为直线，可选为：'line' | 'shadow'
					}
				},
				legend: {
					data: ['简单', '中等', '困难']
				},
				grid: {
					left: '3%',
					right: '4%',
					bottom: '3%',
					containLabel: true
				},
				xAxis: {
					type: 'value'
				},
				yAxis: {
					type: 'category',
					data: ['单选题', '多选题', '判断题', '填空题', '简答题']
				},
				series: [{
						name: '简单',
						type: 'bar',
						stack: '总量',
						label: {
							normal: {
								show: true,
								position: 'insideRight'
							}
						},
						data: [result.single[1], result.mul[1], result.jud[1], result.tian[1], result.jian[1]]
					},
					{
						name: '中等',
						type: 'bar',
						stack: '总量',
						label: {
							normal: {
								show: true,
								position: 'insideRight'
							}
						},
						data: [result.single[2], result.mul[2], result.jud[2], result.tian[2], result.jian[2]]
					},
					{
						name: '困难',
						type: 'bar',
						stack: '总量',
						label: {
							normal: {
								show: true,
								position: 'insideRight'
							}
						},
						data: [result.single[3], result.mul[3], result.jud[3], result.tian[3], result.jian[3]]
					}
				]
			};
			myChart.setOption(option);
		}


		$(document).ready(function() {
			$.ajax({
				type: 'post',
				url: 'getchartinvite',
				async: false,
				success: function(result) {
					console.log(result);
					adddatachart(result);
				}
			});

			$.ajax({
				type: 'post',
				url: 'getchartcheckin',
				async: false,
				success: function(result) {
					console.log(result);
					addcheckinchart(result);
				}
			});

			$.ajax({
				type: 'post',
				url: 'getquestioneasy',
				async: false,
				success: function(result) {
					console.log(result);
					addeasy(result);
				}
			});
			$.ajax({
				type: 'post',
				url: 'geterror',
				async: false,
				success: function(result) {
					adderrorexam(result);
				}
			});
		});
	</script>
	<script type="text/javascript">
		var myChart = echarts.init(document.getElementById('nowcost'));
		myChart.setOption({
			title: {
				text: '动态获取收益'
			},
			tooltip: {},
			legend: {
				data: ['销量']
			},
			toolbox: {
				show: true,
				feature: {
					dataView: {
						readOnly: false
					},
					restore: {},
					saveAsImage: {}
				}
			},
			xAxis: {
				data: []
			},
			yAxis: {},
			series: [{
				name: '销量',
				type: 'bar',
				data: []
			}]
		});

		myChart.showLoading(); //数据加载完之前先显示一段简单的loading动画

		var names = []; //类别数组（实际用来盛放X轴坐标值）
		var nums = []; //销量数组（实际用来盛放Y坐标值）
		var id = 0;

		setInterval(function() {
			$.ajax({
				type: "post",
				async: true, //异步请求（同步请求将会锁住浏览器，用户其他操作必须等待请求完成才可以执行）
				url: "costServlet", //请求发送到TestServlet处
				data: {
					id: id
				},
				dataType: "json", //返回数据形式为json
				success: function(result) {
					//请求成功时执行该函数内容，result即为服务器返回的json对象
					console.log(result);
					
						for (var i = 0; i < result.length; i++) {
							if (result[i].recordid > id) {
								id = result[i].recordid;
							}
							names.push(result[i].date); //挨个取出类别并填入类别数组
						}
						for (var i = 0; i < result.length; i++) {
							nums.push(result[i].cost); //挨个取出销量并填入销量数组
						}
						myChart.hideLoading(); //隐藏加载动画
						myChart.setOption({ //加载数据图表
							xAxis: {
								data: names
							},
							series: [{
								// 根据名字对应到相应的系列
								name: '销量',
								data: nums
							}]
						});
			
					
			
				},
				error: function(errorMsg) {
					//请求失败时执行该函数
					alert("图表请求数据失败!");
					myChart.hideLoading();
				}
			})
		}, 3000);
	</script>
</html>
