<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

	<head>

		<!-- Basic -->
		<meta charset="UTF-8" />

		<title>Map Basic | Fire - Admin Template</title>

		<!-- Mobile Metas -->
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

		<!-- Import google fonts -->
		<!-- <link href='http://fonts.useso.com/css?family=Titillium+Web' rel='stylesheet' type='text/css'> -->

		<!-- Favicon and touch icons -->
		<link rel="shortcut icon" th:href="@{static/assets/ico/favicon.ico}" type="image/x-icon" />
		<link rel="apple-touch-icon" th:href="@{static/assets/ico/apple-touch-icon.png}" />
		<link rel="apple-touch-icon" sizes="57x57" th:href="@{static/assets/ico/apple-touch-icon-57x57.png}" />
		<link rel="apple-touch-icon" sizes="72x72" th:href="@{static/assets/ico/apple-touch-icon-72x72.png}" />
		<link rel="apple-touch-icon" sizes="76x76" th:href="@{static/assets/ico/apple-touch-icon-76x76.png}" />
		<link rel="apple-touch-icon" sizes="114x114" th:href="@{static/assets/ico/apple-touch-icon-114x114.png}" />
		<link rel="apple-touch-icon" sizes="120x120" th:href="@{static/assets/ico/apple-touch-icon-120x120.png}" />
		<link rel="apple-touch-icon" sizes="144x144" th:href="@{static/assets/ico/apple-touch-icon-144x144.png}" />
		<link rel="apple-touch-icon" sizes="152x152" th:href="@{static/assets/ico/apple-touch-icon-152x152.png}" />

		<!-- start: CSS file-->

		<!-- Vendor CSS-->
		 
		<link th:href="@{static/assets/vendor/bootstrap/css/bootstrap.min.css}" rel="stylesheet" />
		<link th:href="@{static/assets/vendor/skycons/css/skycons.css}" rel="stylesheet" />
		<link th:href="@{static/assets/vendor/font-awesome/css/font-awesome.min.css}" rel="stylesheet" />
		<link th:href="@{static/assets/vendor/css/pace.preloader.css}" rel="stylesheet" />

		<!-- Plugins CSS-->
		<link th:href="@{static/assets/plugins/bootkit/css/bootkit.css}" rel="stylesheet" />

		<!-- Theme CSS -->
		<link th:href="@{static/assets/css/jquery.mmenu.css}" rel="stylesheet" />

		<!-- Page CSS -->
		<link th:href="@{static/assets/css/style.css}" rel="stylesheet" />
		<link th:href="@{static/assets/css/add-ons.min.css}" rel="stylesheet" />

		<!-- end: CSS file-->

		<!-- Head Libs -->
		<script th:src="@{static/assets/plugins/modernizr/js/modernizr.js}"></script>

		<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		<!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
			<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->

	</head>

	<body>
		<!-- Start: Header -->
		<div class="navbar" role="navigation">
			<div class="container-fluid container-nav">
				<ul class="nav navbar-nav navbar-actions navbar-left">
							<li class="visible-md visible-lg"><a href="#" id="main-menu-toggle"><i class="fa fa-th-large"></i></a></li>
							<li class="visible-xs visible-sm"><a href="#" id="sidebar-menu"><i class="fa fa-navicon"></i></a></li>			
						</ul>
						<div class="col-lg-6 bk-fg-info">
						<a class="col-xs-2 bk-fg-info" href="home">
						<i class=" glyphicon glyphicon-home"></i> <small> 首页</small>
						</a>
						<a class="col-xs-2 bk-fg-info" href="toshop">
						<i class="fa fa-shopping-cart"></i> <small> 商城</small>
						</a>
						<a class="col-xs-2 bk-fg-info" href="grouphome">
						<i class="fa fa-envelope"></i> <small> 群组</small>
						</a>
						
						</div>
						
						<!-- Navbar Right -->
						<div class="navbar-right">					
							<!-- Notifications -->
							<ul class="notifications hidden-xs">
								
							</ul>
							<!-- End Notifications -->					
							<!-- Userbox -->
							<div class="userbox">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">
									<figure class="profile-picture hidden-xs">
										<img th:src="${session.user.headphoto}" class="img-circle" alt="" />
									</figure>
									<div class="profile-info">
										<span class="name">用户名：<span th:text="${session.user.nickname}"></span></span>
										<span class="role"><i class="fa fa-circle bk-fg-success"></i> 用户类型:<span th:text="${session.user.type}"></span></span>
									</div>			
									<i class="fa custom-caret"></i>
								</a>
								<div class="dropdown-menu bk-padding-top-70">
									<ul class="list-unstyled">	
										<li>
											<a href="getinpeoplehome"><i class="fa fa-user"></i>个人中心</a>
										</li>
										<li>
											<a href="topayhome"><i class="fa fa-usd"></i>账户充值</a>
										</li>
										<li>
											<a href="loginoutMJ"><i class="fa fa-power-off"></i>退出</a>
										</li>
									</ul>
								</div>						
							</div>
					<!-- End Userbox -->
				</div>
				<!-- End Navbar Right -->
			</div>
		</div>
		<!-- End: Header -->

		<!-- Start: Content -->
		
		<div   class="container-fluid content" style="" >
			<!--<div class="row">-->
			<!-- Main Page -->
			<div  class="main " style="height: 100%; width: 100%; background:url(static/assets/img/gallery/sky5.jpg);  padding-top: 100px;  background-size: cover;">
				<div class="row" >
					<div class="col-lg-1 col-md-1 col-sm-1 col-xs-12"></div>
					<div class="col-lg-8 col-md-8 col-sm-8 col-xs-10">
						<div class="col-md-12">
							<div class="col-lg-1 col-md-1 col-sm-1 col-xs-1"></div>
							<div class="col-lg-9 col-md-9 col-sm-9 col-xs-9">
								<div class="row">
									<video id="video" width="100%" height="100%" controls></video>
									<canvas id="canvas" width="480" height="320" style="display: none;"></canvas>
								</div>
								<div class="row" style="padding-top: 30px;">
									<center>
									<div class="input-group">
											<span class="input-group-btn">
												<button class="btn btn-success" id="capture" type="button" style="width: 150px; height: 50px;">验证并进入考试</button>
											</span>
									</div>
									</center>
								</div>
								<div class="row">
										<br><br>
									<div class="helper-wrapper">
									<h4 class="mb10">注意事项：</h4>
									<p class="mb10">1. 请使用IE9及以上版本、Chrome、Sogou、Firefox、Safari、QQ、360浏览器。Sogou、360浏览器请使用极速模式，不能使用兼容模式。如果遇到异常可以换一个浏览器再试。
									</p>
								
									<p class="mb10">
										2. <span>正式考试之前请关闭弹窗应用如QQ、屏保等，答题中不要访问考试窗口之外的区域。如果有窗口意外弹出请立即关闭。</span>
									</p>
									<p class="mb10">3. 请在规定时间作答完全部题目，考试时间结束时，无论是否答完系统都将自动交卷。</p>
									<p class="mb10">4. 如果答题过程中因电源、网络故障等造成中断，请退出并在几分钟之内再次按照相同的步骤进入考试，从中断处继续答题。
									</p>
								
									<h4 class="mt30 mb10">Q &amp; A：</h4>
									<p class="text-knewone mb5">Q. 我收到了通知考试的短信，没有收到邀请邮件，怎么办？</p>
									<p class="mb20">A. 请检查下垃圾邮件箱，如果还是没有，请去掉反垃圾设置，并将我们加入白名单，然后在本页面中，输入短信中的姓名和邮箱，给自己重发一封邀请邮件。
									</p>
									<p class="text-knewone mb5">Q. 我怎样进入考试？</p>
									<p class="mb20">A. 如果收到了考试邀请邮件，则直接点击邮件中的链接即可进入考试。或者，如果得到了考试口令，则在本页面中输入考试口令进入考试。
									</p>
									<p class="text-knewone mb5">Q. 参加电脑考试必须要有摄像头吗？</p>
									<p class="mb20">A. 系统使用flash技术和摄像头进行拍照和监考，如果试卷上设置了需要拍照和监考，则答题的电脑必须安装flash和摄像头，否则不需要。一般情况下远程考试都需要在监考环境下进行。
									</p>
									<p class="text-knewone mb5">Q. 考试完毕后可以查成绩吗？</p>
									<p class="mb20">A. 请在本页面输入考试结束时的查询码查成绩和错题；或使用考试时填写的身份信息来注册，登录后在页面右上角我的成绩中查询。手机端答题按同样方式查询。上述查询需要试卷开放查询权限，否则不允许查询，请联系考试的组织者。
									</p>
								</div>
							</div>
						</div>
					    
					</div>
				</div>
				<!--	</div>-->
				<!-- End Main Page -->
			</div>
		</div>
	
		<!--/container-->

		<!-- start: JavaScript-->

		<!-- Vendor JS-->
		<script th:src="@{static/assets/vendor/js/jquery.min.js}"></script>
		<script th:src="@{static/assets/vendor/js/jquery-2.1.1.min.js}"></script>
		<script th:src="@{static/assets/vendor/js/jquery-migrate-1.2.1.min.js}"></script>
		<script th:src="@{static/assets/vendor/bootstrap/js/bootstrap.min.js}"></script>
		<script th:src="@{static/assets/vendor/skycons/js/skycons.js}"></script>
		<script th:src="@{static/assets/vendor/js/pace.min.js}"></script>

		<!-- Plugins JS-->
		<!-- <script src="http://maps.google.com/maps/api/js?sensor=false"></script> -->
		<script th:src="@{static/assets/plugins/sparkline/js/jquery.sparkline.min.js}"></script>

		<!-- Theme JS -->
		<script th:src="@{static/assets/js/jquery.mmenu.min.js}"></script>
		<script th:src="@{static/assets/js/core.min.js}"></script>

		<!-- Pages JS -->
		<input type="text" id="testid" th:value="${testid}" style="display: none;">
		<!-- end: JavaScript-->
	</body>
<script>
    function getUserMedia(constraints, success, error) {
      if (navigator.mediaDevices.getUserMedia) {
        navigator.mediaDevices.getUserMedia(constraints).then(success).catch(error);
      } else if (navigator.webkitGetUserMedia) {
        //webkit
        navigator.webkitGetUserMedia(constraints,success, error)
      } else if (navigator.mozGetUserMedia) {
        //firfox
        navigator.mozGetUserMedia(constraints, success, error);
      } else if (navigator.getUserMedia) {
        //API
        navigator.getUserMedia(constraints, success, error);
      }
    }
 
    let video = document.getElementById('video');
    let canvas = document.getElementById('canvas');
    let context = canvas.getContext('2d');
 
    function success(stream) {
      //����webkit���������
      let CompatibleURL = window.URL || window.webkitURL;
      //����Ƶ������ΪvideoԪ�ص�Դ
      console.log(stream);
 
      //video.src = CompatibleURL.createObjectURL(stream);
      video.srcObject = stream;
      video.play();
    }
 
    function error(error) {
      console.log(`�����û�ý���豸ʧ��${error.name}, ${error.message}`);
    }
 
    if (navigator.mediaDevices.getUserMedia || navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia) {
      //�����û�ý���豸, ��������ͷ
	alert(video);
      getUserMedia({video : {width: 480, height: 320}}, success, error);
    } else {
      alert('��֧�ַ����û�ý��');
    }
	
	$(document).ready(function(){
		$.ajax({
			//2bcfab7f32b3d497caa50b24652beaba
			type:'get',
			url:'https://restapi.amap.com/v3/ip?ip=114.247.50.2&output=json&key=2bcfab7f32b3d497caa50b24652beaba',
			async:false,
			success:function(result){
				var a= JSON.stringify(result);
				alert(a);
			}
		});	
		
	});
		
    document.getElementById('capture').addEventListener('click', function () {
      context.drawImage(video, 0, 0, 480, 320);      
		basePath = canvas.toDataURL();
		alert(basePath);
		basePath = basePath.substring(22);
		var testid = $("#testid").val();
		$.ajax({
			type:'post',
			url:'loadtest',
			async:false,
			dataType:'text',
			data:{basePath:basePath},
			success:function(result){
				window.location.href="testhome?testid="+testid;
			}
		});		

				//alert(basePath);
    })
  </script>


	
</html>