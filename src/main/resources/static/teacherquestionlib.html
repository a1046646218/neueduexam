<!DOCTYPE html>
<html  xmlns:th="http://www.thymeleaf.org">

	<head>
	
		<!-- Basic -->
    	<meta charset="UTF-8" />

		<title>Map Basic | Fire -  Admin Template</title>
	
		<!-- Mobile Metas -->
	    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		
		<!-- Import google fonts -->
        <!-- <link href='http://fonts.useso.com/css?family=Titillium+Web' rel='stylesheet' type='text/css'> -->
        
		<!-- Favicon and touch icons -->
		<link rel="shortcut icon" th:href="@{static/assets/ico/favicon.ico}" type="image/x-icon" />
		<link rel="apple-touch-icon" th:href="@{static/assets/ico/apple-touch-icon.png}" />
		<link rel="apple-touch-icon" sizes="57x57" th:href="@{static/assets/ico/apple-touch-icon-57x57.png}" />
		<link rel="apple-touch-icon" sizes="72x72" th:href="@{static/assets/ico/apple-touch-icon-72x72.png}" />
		<link rel="apple-touch-icon" sizes="76x76" th:href="@{static/assets/ico/apple-touch-icon-76x76.png}" />
		<link rel="apple-touch-icon" sizes="114x114" th:href="@{static/assets/ico/apple-touch-icon-114x114.png}" />
		<link rel="apple-touch-icon" sizes="120x120" th:href="@{static/assets/ico/apple-touch-icon-120x120.png}" />
		<link rel="apple-touch-icon" sizes="144x144" th:href="@{static/assets/ico/apple-touch-icon-144x144.png}" />
		<link rel="apple-touch-icon" sizes="152x152" th:href="@{static/assets/ico/apple-touch-icon-152x152.png}" />
		
	    <!-- start: CSS file-->
		
		<!-- Vendor CSS-->
		<link th:href="@{static/assets/vendor/bootstrap/css/bootstrap.min.css}" rel="stylesheet" />
		<link th:href="@{static/assets/vendor/skycons/css/skycons.css}" rel="stylesheet" />
		<link th:href="@{static/assets/vendor/font-awesome/css/font-awesome.min.css}" rel="stylesheet" />
		<link th:href="@{static/assets/vendor/css/pace.preloader.css}" rel="stylesheet" />
		
		<!-- Plugins CSS-->
		<link th:href="@{static/assets/plugins/bootkit/css/bootkit.css}" rel="stylesheet" />
		
		<!-- Theme CSS -->
		<link th:href="@{static/assets/css/jquery.mmenu.css}" rel="stylesheet" />
		
		<!-- Page CSS -->		
		<link th:href="@{static/assets/css/style.css}" rel="stylesheet" />
		<link th:href="@{static/assets/css/add-ons.min.css}" rel="stylesheet" />
		<!-- end: CSS file-->	
	    
		<!-- 我的js-->
		<script th:src="@{static/js/echarts.min.js}"></script>
		<!-- <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/echarts.min.js"></script> -->
		<!-- Head Libs -->
		<script th:src="@{static/assets/plugins/modernizr/js/modernizr.js}"></script>
		<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		<!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
			<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->		
		
	</head>
	
	<body>
	
		<!-- Start: Header -->
		<div class="navbar" role="navigation">
			<div class="container-fluid container-nav">
				
				<!-- Navbar Left -->
				
				<!-- Navbar Right -->
				<div class="col-lg-6 bk-fg-info">
				<a class="col-xs-2 bk-fg-info" href="home">
				<i class=" glyphicon glyphicon-home"></i> <small> 首页</small>
				</a>
				<a class="col-xs-2 bk-fg-info" href="toshop">
				<i class="fa fa-shopping-cart"></i> <small> 商城</small>
				</a>
				<a class="col-xs-2 bk-fg-info" href="grouphome">
				<i class="fa fa-envelope"></i> <small> 群组</small>
				</a>
				
				</div>
				
				<!-- Navbar Right -->
				<div class="navbar-right">					
					<!-- Notifications -->
					<ul class="notifications hidden-xs">
						
					</ul>
					<!-- End Notifications -->					
					<!-- Userbox -->
					<div class="userbox">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown">
							<figure class="profile-picture hidden-xs">
								<img th:src="${session.user.headphoto}" class="img-circle" alt="" />
							</figure>
							<div class="profile-info">
								<span class="name">用户名：<span th:text="${session.user.nickname}"></span></span>
								<span class="role"><i class="fa fa-circle bk-fg-success"></i> 用户类型:<span th:text="${session.user.type}"></span></span>
							</div>			
							<i class="fa custom-caret"></i>
						</a>
						<div class="dropdown-menu bk-padding-top-70">
							<ul class="list-unstyled">	
								<li>
									<a href="getinpeoplehome"><i class="fa fa-user"></i>个人中心</a>
								</li>
								<li>
									<a href="topayhome"><i class="fa fa-usd"></i>账户充值</a>
								</li>
								<li>
									<a href="loginoutMJ"><i class="fa fa-power-off"></i>退出</a>
								</li>
							</ul>
						</div>						
					</div>
					<!-- End Userbox -->
				</div>
				<!-- End Navbar Right -->
			</div>		
		</div>
		<!-- End: Header -->
		
		<!-- Start: Content -->
		<div class="container-fluid content">	
			<div class="row">
			
				<!-- Sidebar -->
				<div class="sidebar">
					<div class="sidebar-collapse">
						<!-- Sidebar Header Logo-->
						<div class="sidebar-header">
							<img th:src="@{static/assets/img/logo.png}" class="img-responsive" alt="" />
						</div>
						<!-- Sidebar Menu-->
						<div class="sidebar-menu">						
							<nav id="menu" class="nav-main" role="navigation">
								<ul class="nav nav-sidebar">
									<div class="panel-body text-center">								
										<div class="flag">
											<button type="button" data-toggle="modal" data-target="#createexammodel" class="bk-margin-10 btn btn-primary btn-lg"><i class="fa fa-pencil-square-o"></i>创建试卷</button>
											<!-- <img th:src="@{static/assets/img/flags/USA.png}" class="img-flags" alt="" /> -->
										</div>
									</div>
									<li>
										<a href="toteacherhome">
											<i class="fa fa-laptop" aria-hidden="true"></i><span>个人中心</span>
										</a>
									</li>
										<li class="nav-parent">
										<a>
											<i class="fa fa-table" aria-hidden="true"></i><span>我的考试</span>
										</a>
										<ul class="nav nav-children">
											<li><a href="toteacherhasexam"><span class="text"> 我的卷纸</span></a></li>
											<li><a href="toteacherpublichexam"><span class="text"> 发布的卷纸</span></a></li>
										</ul>
									</li>
									<li>
										<a href="toteacherquestionlib">
											<!-- <span class="pull-right label label-danger">235</span> -->
											<i class="fa fa-folder-o" aria-hidden="true"></i><span>我的题库</span>
										</a>
									</li>
									<li>
										<a href="grouphome">
											<!-- <span class="pull-right label label-danger">235</span> -->
											<i class="fa fa-folder-o" aria-hidden="true"></i><span>我的群组</span>
										</a>
									</li>
									<li>
										<a href="toteacherpayrecord">
											<i class="fa  fa-shopping-cart" aria-hidden="true"></i><span>消费记录</span>
										</a>
									</li>				
									
								</ul>
							</nav>
						</div>
						<!-- End Sidebar Menu-->
					</div>
					<!-- Sidebar Footer-->
					<div class="sidebar-footer">					
						<div class="small-chart-visits">
							<div class="small-chart" id="sparklineLineVisits"></div>
							<div class="small-chart-info">
								<label>New Visits</label>
								<strong>70,79%</strong>
							</div>
							<script type="text/javascript">
								var sparklineLineVisitsData = [15, 16, 17, 19, 15, 25, 23, 35, 29, 15, 30, 45];
							</script>
						</div>
						<ul class="sidebar-terms bk-margin-top-10">
							<li><a href="#">Terms</a></li>
							<li><a href="#">Privacy</a></li>
							<li><a href="#">Help</a></li>
							<li><a href="#">About</a></li>
						</ul>					
					</div>
					<!-- End Sidebar Footer-->
				</div>
				<!-- End Sidebar -->
				
				<!-- Main Page -->
				<div class="main ">
					<!-- Page Header -->
					<div class="page-header">
						<div class="pull-left">
							<ol class="breadcrumb visible-sm visible-md visible-lg">								
								<li><a href="toteacherhome" class="active"><i class="icon fa fa-home"></i>我的题库</a></li>
							</ol>						
						</div>
					</div>
					<!-- End Page Header -->		
					<div>
							<div class="inner-toolbar">
								<ul>
									<li>
										<a href="#" id="addquestionlib" data-toggle="modal" data-target="#myModal"><i class="fa fa-pencil"></i>添加题库</a>
									</li>
								</ul>
							</div>
					<div style="padding-top:50px;">
					<div class = "row" rownum="0"></div>
					<div class = "row" rownum="1"></div>
					<div class="row">
					<div style="float:right;padding-right:100px;">
						<div>
							<button type="button" id="beforepage" class="bk-margin-5 btn btn-default">上一页</button>
							<button type="button" class="btn btn-default" id="pagenum" >1</button>
							<button type="button" id="afterpage" class="bk-margin-5 btn btn-default">下一页</button>
											<!-- <a class="btn btn-warning" role="button" id="beforepage">上一页</a>
											<a class="btn btn-warning" role="button" id="pagenum">1</a>
											<a class="btn btn-warning" role="button" id="afterpage">下一页</a> -->
						</div>
					</div>
					</div>
					</div>
					</div>	
				</div>
				</div>
				<!-- End Main Page -->
				
				<!-- Footer -->
				
				<!-- End Footer -->
			
			</div>
		</div><!--/container-->
			
		
		<!-- <div class="clearfix"></div> -->		
		
		
		<!-- start: JavaScript-->
		
		<!-- Vendor JS-->				
		<script th:src="@{static/assets/vendor/js/jquery.min.js}"></script>
		<script th:src="@{static/assets/vendor/js/jquery-2.1.1.min.js}"></script>
		<script th:src="@{static/assets/vendor/js/jquery-migrate-1.2.1.min.js}"></script>
		<script th:src="@{static/assets/vendor/bootstrap/js/bootstrap.min.js}"></script>
		<script th:src="@{static/assets/vendor/skycons/js/skycons.js}"></script>
		<script th:src="@{static/assets/vendor/js/pace.min.js}"></script>
		
		<!-- Plugins JS-->
		<!-- <script src="http://maps.google.com/maps/api/js?sensor=false"></script> -->
		<!-- <script th:src="@{static/assets/plugins/gmaps/gmaps.js}"></script> -->
		<script th:src="@{static/assets/plugins/sparkline/js/jquery.sparkline.min.js}"></script>
		
		<!-- Theme JS -->		
		<script th:src="@{static/assets/js/jquery.mmenu.min.js}"></script>
		<script th:src="@{static/assets/js/core.min.js}"></script>
		<script th:src="@{static/layer/layer.js}"></script>
		<script th:src="@{static/layer/extend/layer.ext.js}"></script>
		<!-- Pages JS -->
				  <script th:src="@{static/js/template.js}"></script>
		<!-- <script th:src="@{static/assets/js/pages/map-basic.js}"></script> -->
		<!-- end: JavaScript-->
		<link rel="stylesheet" type="text/css" th:href="@{static/dropzone/dropzone.css}">
		<!-- <link rel="stylesheet" type="text/css" th:href="@{static/dist/dropzone.min.css}"> -->
		 <script th:src="@{static/dropzone/dropzone.js}"></script>
		 
		 
		<script type="text/html" id="contentTemplate">
			<div class="col-lg-3 panel bk-widget bk-border-off" >
				<div class="panel-body bk-padding-20" style="border-top:2px solid #0FB492;">
					<div class="bk-bg-white text-center  bk-padding-bottom-10">
						<div class="row">
							<div class="col-xs-9 text-left bk-vcenter">
								
									<h4 class="bk-margin-off">{{libname}}</h4>
									发布时间：{{publishtime}}
								
							</div>
							<div class="col-xs-3 bk-vcenter text-right">
								<i class="fa fa-folder-open fa-2x"></i>
							</div>
						</div>
					</div>
					
					<div class="row  bk-padding-bottom-10">
						<div  class="col-lg-5 "style="padding-left:10px;padding-right: 0px;" >
									<div class=" btn-group">
									  <button type="button" class="btn dropdown-toggle" data-toggle="dropdown" style="border-bottom:0px;">
										<a href="#" class="bk-fg-info">
											<i class="fa fa-plus-square-o"></i> 添加 <span class="caret"></span></a>	
											<!--<span class="sr-only">Toggle Dropdown</span>-->
										</button>
									<ul class="dropdown-menu" role="menu">
									<li><a href="toaddquestion?libid={{libid}}">单个添加习题</a></li>
									<li><a id="addquesecxcel" name="{{libid}}">批量导入习题</a></li>
									</ul>
								</div>
								</div>
								<div  class="col-lg-3 " id="removelib" libid="{{libid}}" style="padding-left: 0px;padding-right: 0px;">
									<button type="button" class="btn" style="padding-left: 0px;padding-right: 0px;border-bottom:0px;">
									<a href="#" class="bk-fg-danger"><i class="fa  fa-trash-o "></i> 删除</a>
								    </button>
								</div>
								<div class="col-lg-3" id="salelib" libid="{{libid}}" style="padding-left: 0px;padding-right: 0px;">
									<button type="button" class="btn" style="padding-left: 0px;padding-right: 0px;border-bottom:0px;">
									<a href="#" class="bk-fg-warning"><i class="fa  fa-money "></i> 出售</a>
								   </button>
								</div>	
					</div>
					
					<ul class="list-group bk-margin-bottom-5">
						<li class="list-group-item">
							<span class="badge bk-bg-info">{{libtype}}</span>
							题库类型：
						</li>
						<li class="list-group-item">
							<span class="badge bk-bg-danger">{{quesamount}}道</span>
							题目数量：
						</li>
					</ul>
				</div>
			</div>
		</script>
	<script type="text/javascript">
       var page = 1;
       function change(num){
       	$.ajax({
       		type:'post',
       		url:'getquestionlibAjaxControllerDTF',
       		async:false,
       		data:"page="+page,
       		success:function(result){
       			if($.isEmptyObject(result)){
					layer.msg("没有更多内容");
       				page = page-1;
       				$('#pagenum').text(page);
       				return;
       			}
       			$("[rownum=\"1\"]").empty();
       			$("[rownum=\"0\"]").empty();
       			// //alert(JSON.stringify(result));
       			var num = result.length%4;
       			if(num!=0)
       				num=1;
       			for(var i=0;i<result.length/4+num;i++){
       				var j=0;
       				for(var time=i*4;time<result.length&&j<4;j++,time++){
       					var newContentNews = template("contentTemplate",result[time]);
       					$("[rownum=\""+i+"\"]").append(newContentNews);
       				}
       			}
       		}
       	});				
       }
       $('#afterpage').click(function(){
       	page = page+1;
       	$('#pagenum').text(page);
       	change(page);
       });
       $('#beforepage').click(function(){
       	if(page!=1){
       	page = page-1;
       	$('#pagenum').text(page);
       	change(page);
       	}	
       });
       $(document).ready(function(){
       	change(page);
       });
       
    </script>
	</body>
	<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
			<div class="modal-dialog" style="width:480px;height: 400px;">
				<div class="modal-content">
					<div id="hhh" laynum="" class="panel-body" style="width:480px;height: 400px;">
													<form action="" method="post">
														<div class="form-group">
															<label for="nf-email">题库名称</label>
															<input type="text" id="clibname" name="libName" class="form-control" placeholder="题库名称">
															<span  id="help_clibname" class="help-block">请输入题库的名称</span>
														</div>
														<div class="form-group">
															<label for="nf-email">题库类型</label>
															<input type="text" id="clibtype" name="libType" class="form-control" placeholder="题库类型">
															<span id="help_clibtype" class="help-block">请输入题库的类型</span>
														</div>
														<div class="form-group">
															<label for="nf-email">题库简介</label>
																<textarea  id="clibpro" class="form-control" rows="3"></textarea>
															<span id="help_clibpro" class="help-block">请输入题库的题库简介</span>
														</div>
														<div class="row">
														<div class="col-lg-8 col-md-8 col-sm-8"></div>
														<div class="col-lg-4 col-md-4 col-sm-4">
															<button id="createlib" class="bk-margin-5 btn btn-labeled btn-success" type="button">
															<span class="btn-label"><i class="fa fa-check"></i></span>创建题库</button>
														</div>
														</div>
													</form>
						</div>
						</div><!-- /.modal-content -->
					</div><!-- /.modal-dialog -->
	</div>
	<!-- <button type="button" class="btn btn_5 btn-lg btn-primary" id="chakan" style="font-size: 15px;" data-toggle="modal" data-target="#myModal"> -->
<script type="application/javascript">
	
		$("#removelib").live("click",function(){
			//alert("111111");
			//alert(str);
			var arr=$(this).attr("libid");
			//alert(arr);
			$.ajax({
					type:'post',
					url:'removelibAjaxDTF',
					async:false,
					data:{"libid":arr},
					success:function(flag){
						if(flag==1){
							layer.msg('删除成功', {time: 5000, icon:6});
							setTimeout(function(){
							        window.location.href="toteacherquestionlib";
							//      $(".modal-backdrop.fade").hide();
							},1000);
						}
					}
			});
		});
		
		$("#salelib").live("click",function(){
			//alert("111111");
			var arr=$(this).attr("libid");
			//alert(arr);
			layer.prompt({title: '请输入您的密码', formType: 1}, function(pass, index){
					layer.close(index);
					$.ajax({
							type:'post',
							url:'ispasswordtrue',
							async:false,
							data:{"pass":pass},
							success:function(flag){
								if(flag==1){
									layer.prompt({title: '请输入修改题库的价格', formType: 0}, function(text, index){
									layer.close(index);
									$.ajax({
											type:'post',
											url:'changesalepoint',
											async:false,
											data:{"text":text,"libnum":arr},
											success:function(flag){
												if(flag==1){
													layer.msg('修改成功：<br>价格为：'+text+' 积分');
												}else{
													layer.msg('修改失败');
													
												}
											}
									});
									})
								}else{
									layer.msg("密码错误");
								}
							}
					});
					
				});
		});
	
		$("#createlib").click(function(){
			var clibname = $("#clibname").val().trim().replace(/\s/g,"");
			var clibtype = $("#clibtype").val().trim().replace(/\s/g,"");
			var clibpro  = $("#clibpro").val().trim().replace(/\s/g,"");
			var  flag1 = 0;
			var  flag2 = 0;
			var  flag3 = 0;
			if(clibname==""){
				$("#help_clibname").html("<font style=\"color: #BD2D29;\">题库名称不能为空</font>");
				flag1 = 0
			}else{
				$("#help_clibname").html("<font style=\"color:  #01B6AD;\">输入正确</font>");
				flag1 = 1;
			}
			if(clibtype==""){
				$("#help_clibtype").html("<font style=\"color: #BD2D29;\">题库类型不能为空</font>");
				flag2 = 0;
			}else{
				$("#help_clibtype").html("<font style=\"color:  #01B6AD;\">输入正确</font>");
				flag2 = 1;
			}
			if(clibpro.length>110||clibpro.length<10){
				$("#help_clibpro").html("<font style=\"color: #BD2D29;\">题库描述不能低于10字,不能高于110字</font>");
				flag3 = 0;
			}else{
				$("#help_clibpro").html("<font style=\"color:  #01B6AD;\">输入正确</font>");
				flag3 = 1;
			}
			if(flag1==1&&flag2==1&&flag3==1){
				$.ajax({
					type:'post',
					url:'createlibAjaxDTF',
					async:false,
					data:{"clibname":clibname,"clibtype":clibtype,"clibpro":clibpro},
					success:function(flag){
						if(flag==1){
							layer.msg('添加成功', {time: 5000, icon:6});
							$('#myModal').modal('hide');
							 setTimeout(function(){
                				window.location.href="toteacherquestionlib";
//                 				$(".modal-backdrop.fade").hide();
            				},1000);
						}
					}
				});
			}
			
		});
	</script>
	<input type="button" id="addsomeexcel" style="display: none;" data-toggle="modal" data-target="#addmyexcel">
	<div class="modal fade" id="addmyexcel" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
				<div class="modal-dialog" style="width:600px;height: 400px;">
					<div id="innerexcel" class="modal-content">
							<form method="post" style="margin-left: 40px;width:520px;height: 250px; margin-top:30px;" id="myDropzone" enctype="multipart/form-data" class="dropzone col-md-8" action="mulExceluploadtolib" />
							</form>
						<div class="row" style="margin-top: 35px; margin-left: 480px" >
							<button id="submit" class="bk-margin-5 btn btn-labeled btn-success" type="button">
									<span class="btn-label"><i class="fa fa-check"></i></span>提交</button>
						</div>
					</div><!-- /.modal-content -->
				</div><!-- /.modal-dialog -->
	</div>
	<script type="application/javascript">
		Dropzone.options.myDropzone = {
			autoProcessQueue: false,
			addRemoveLinks:true,
			acceptedFiles:".xls,.xlsx",
				dictInvalidFileType: "你不能上传该类型文件,文件类型只能是*.xls,*.xlsx",
					init: function() {
						var submitButton = document.querySelector("#submit");
						myDropzone = this; // closure
						submitButton.addEventListener("click", function() {
						myDropzone.processQueue(); // Tell Dropzone to process all queued files.
						});
					
				}
	};
	</script>
	<script type="application/javascript">
		$("#addquesecxcel").live("click",function(){
			var arr = $(this).attr("name");
			layer.prompt({title: '请输入您的密码', formType: 1}, function(pass, index){
					layer.close(index);
					$.ajax({
							type:'post',
							url:'ispasswordtrue',
							async:false,
							data:{"pass":pass},
							success:function(flag){
								if(flag==1){
									$.ajax({
											type:'post',
											url:'addquestionexcelsession',
											async:false,
											data:{"libid":arr},
											success:function(flag){
												$("#addsomeexcel").click();
											}
									});
								}else{
									layer.msg("密码错误");
								}
							}
					});
					
			});
			
			
			
		});
		
		
		
		
	</script>
	<div class="modal fade" id="createexammodel" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
				<div class="modal-dialog" style="width:480px;height: 280px;">
					<div class="modal-content bk-padding-15" style="width:450px;height: 250px;">
						<div class="col-lg-1">
						</div>
					<div class="col-lg-4 bk-padding-15" >
						<div class="panel bk-widget bk-border-off">
										<a class="panel-body bk-fg-primary bk-bg-white bk-ltr">
										<div class="text-left bk-vcenter bk-padding-off">
										<span class="bk-round bk-border-white bk-icon bk-icon-3x bk-bg-primary">
										<i class="fa  fa-desktop fa-3x"></i>
										</span>
										</div>
										<div class=" bk-vcenter ">
										<h4 class=" texbk-margin-off">智能创卷</h3>
										<h6 class="bk-fg-gray">可以根据用户所填试卷信息自动生成试卷</h6>
										
										</div>
										</a>
						</div>
					</div>
					<div class="col-lg-2"></div>
					<div class="col-lg-4 bk-padding-15">
						<div class="panel bk-widget bk-border-off">
											<a class="panel-body bk-fg-primary bk-bg-white bk-ltr">
											<div class="text-left bk-vcenter bk-padding-off">
											<span class="bk-round bk-border-white bk-icon bk-icon-3x bk-bg-primary">
											<i class="fa fa-user fa-3x"></i>
											</span>
											<div class=" bk-vcenter ">
											<h4 class=" texbk-margin-off">手动创卷</h3>
											<h6 class="bk-fg-gray">用户手动选择要加入的题库</h6>
											
											</div>
											</a>
						</div>
					</div>	
					
					
					
					</div><!-- /.modal-content -->
				</div><!-- /.modal-dialog -->
		</div>
</html>
