<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

	<head>

		<!-- Basic -->
		<meta charset="UTF-8" />

		<title>Pricing Tables | Fire - Admin Template</title>

		<!-- Mobile Metas -->
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="format-detection" content="telephone=no">
		<meta name="renderer" content="webkit">
		<meta http-equiv="Cache-Control" content="no-siteapp" />
		<!-- Import google fonts -->
		<link href='http://fonts.useso.com/css?family=Titillium+Web' rel='stylesheet' type='text/css'>

		<!-- Favicon and touch icons -->
		<link rel="shortcut icon" th:href="@{static/assets/ico/favicon.ico}" type="image/x-icon" />
		<link rel="apple-touch-icon" th:href="@{static/assets/ico/apple-touch-icon.png}" />
		<link rel="apple-touch-icon" sizes="57x57" th:href="@{static/assets/ico/apple-touch-icon-57x57.png}" />
		<link rel="apple-touch-icon" sizes="72x72" th:href="@{static/assets/ico/apple-touch-icon-72x72.png}" />
		<link rel="apple-touch-icon" sizes="76x76" th:href="@{static/assets/ico/apple-touch-icon-76x76.png}" />
		<link rel="apple-touch-icon" sizes="114x114" th:href="@{static/assets/ico/apple-touch-icon-114x114.png}" />
		<link rel="apple-touch-icon" sizes="120x120" th:href="@{static/assets/ico/apple-touch-icon-120x120.png}" />
		<link rel="apple-touch-icon" sizes="144x144" th:href="@{static/assets/ico/apple-touch-icon-144x144.png}" />
		<link rel="apple-touch-icon" sizes="152x152" th:href="@{static/assets/ico/apple-touch-icon-152x152.png}" />

		<!-- start: CSS file-->

		<!-- Vendor CSS-->
		<link th:href="@{static/assets/vendor/bootstrap/css/bootstrap.min.css}" rel="stylesheet" />
		<link th:href="@{static/assets/vendor/skycons/css/skycons.css}" rel="stylesheet" />
		<link th:href="@{static/assets/vendor/font-awesome/css/font-awesome.min.css}" rel="stylesheet" />
		<link th:href="@{static/assets/vendor/css/pace.preloader.css}" rel="stylesheet" />

		<!-- Plugins CSS-->
		<link th:href="@{static/assets/plugins/bootkit/css/bootkit.css}" rel="stylesheet" />
		<link th:href="@{static/assets/plugins/jquery-ui/css/jquery-ui-1.10.4.min.css}" rel="stylesheet" />

		<!-- Theme CSS -->
		<link th:href="@{static/assets/css/jquery.mmenu.css}" rel="stylesheet" />

		<!-- Page CSS -->
		<link th:href="@{static/assets/css/style.css}" rel="stylesheet" />
		<link th:href="@{static/assets/css/add-ons.min.css}" rel="stylesheet" />

		<!-- end: CSS file-->


		<!-- Head Libs -->
		<script th:src="@{static/assets/plugins/modernizr/js/modernizr.js}"></script>

		<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		<!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
			<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->



		<!--b恩盘 -->

	</head>

	<body>

		<!-- Start: Header -->
		<div class="navbar" role="navigation">
			<div class="container-fluid container-nav">
				<!-- Navbar Action -->
				
				<!-- Navbar Right -->
				<ul class="nav navbar-nav navbar-actions navbar-left">
							<li class="visible-md visible-lg"><a href="#" id="main-menu-toggle"><i class="fa fa-th-large"></i></a></li>
							<li class="visible-xs visible-sm"><a href="#" id="sidebar-menu"><i class="fa fa-navicon"></i></a></li>			
						</ul>
						
						<!-- Navbar Right -->
				<!-- End Navbar Right -->
			</div>
		</div>
		<!-- End: Header -->

		<!-- Start: Content -->
		<div class="container-fluid content">
			<div class="row">

				<!-- Sidebar -->
				<div class="sidebar">
					<div class="sidebar-collapse">
						<!-- Sidebar Header Logo-->
						<div class="sidebar-header">
							<img src="assets/img/logo.png" class="img-responsive" alt="" />
						</div>
						<!-- Sidebar Menu-->
						<div class="sidebar-menu">
							<nav id="menu" class="nav-main" role="navigation">
								<ul class="nav nav-sidebar">
									<div class="panel-body text-center">
										<div class="flag">
											<img src="assets/img/flags/USA.png" class="img-flags" alt="" />
										</div>
									</div>
									<li>
										<a href="index.html">
											<i class="fa fa-laptop" aria-hidden="true"></i><span>Dashboard</span>
										</a>
									</li>
									<li>
										<a href="mailbox-inbox.html">
											<span class="pull-right label label-danger">235</span>
											<i class="fa fa-envelope" aria-hidden="true"></i><span>Mail</span>
										</a>
									</li>
									<li class="nav-parent nav-expanded active">
										<a>
											<i class="fa fa-copy" aria-hidden="true"></i><span>Pages</span>
										</a>
										<ul class="nav nav-children">
											<li><a href="page-profile.html"><span class="text"> Profile</span></a></li>
											<li><a href="page-activity.html"><span class="text"> Activity</span></a></li>
											<li><a href="page-timeline.html"><span class="text"> Timeline</span></a></li>
											<li><a href="page-invoice.html"><span class="text"> Invoice</span></a></li>
											<li><a href="page-pricing-tables.html"><span class="text"> Pricing Tables</span></a></li>
											<li><a href="page-login.html"><span class="text"> Login Page</span></a></li>
											<li><a href="page-register.html"><span class="text"> Register Page</span></a></li>
											<li><a href="page-recover-password.html"><span class="text"> Recover Password</span></a></li>
											<li><a href="page-lockscreen1.html"><span class="text"> Lock Screen 1</span></a></li>
											<li><a href="page-lockscreen2.html"><span class="text"> Lock Screen 2</span></a></li>
											<li><a href="page-404.html"><span class="text"> Page 404</span></a></li>
											<li><a href="page-500.html"><span class="text"> Page 500</span></a></li>
										</ul>
									</li>
									<li class="nav-parent">
										<a>
											<i class="fa fa-tasks" aria-hidden="true"></i><span>UI Elements</span>
										</a>
										<ul class="nav nav-children">
											<li><a href="ui-basic-elements.html"><span class="text"> Basic Elements</span></a></li>
											<li><a href="ui-nestable-list.html"><span class="text"> Nestable</span></a></li>
											<li><a href="ui-buttons.html"><span class="text"> Buttons</span></a></li>
											<li><a href="ui-progress-bars.html"><span class="text"> Progress Bars</span></a></li>
											<li><a href="ui-sliders.html"><span class="text"> Sliders</span></a></li>
											<li><a href="ui-panels.html"><span class="text"> Panels</span></a></li>
											<li><a href="ui-tabs.html"><span class="text"> Tabs</span></a></li>
											<li><a href="ui-notifications.html"><span class="text"> Notifications</span></a></li>
											<li><a href="ui-modals.html"><span class="text"> Modals</span></a></li>
											<li><a href="ui-portlets.html"><span class="text"> Portlets</span></a></li>
											<li><a href="ui-lightbox.html"><span class="text"> Lightbox</span></a></li>
											<li><a href="ui-carousels.html"><span class="text"> Carousels</span></a></li>
											<li><a href="ui-animation.html"><span class="text"> Animation</span></a></li>
										</ul>
									</li>
									<li class="nav-parent">
										<a>
											<i class="fa fa-list-alt" aria-hidden="true"></i><span>Forms</span>
										</a>
										<ul class="nav nav-children">
											<li><a href="form-elements.html"><span class="text"> Elements</span></a></li>
											<li><a href="form-wizard.html"><span class="text"> Wizard</span></a></li>
											<li><a href="form-validation.html"><span class="text"> Validation</span></a></li>
											<li><a href="form-dropzone.html"><span class="text"> Dropzone Upload</span></a></li>
											<li><a href="form-editors.html"><span class="text"> Editors</span></a></li>
											<li><a href="form-x-editable.html"><span class="text"> X-Editable</span></a></li>
										</ul>
									</li>
									<li class="nav-parent">
										<a>
											<i class="fa fa-table" aria-hidden="true"></i><span>Tables</span>
										</a>
										<ul class="nav nav-children">
											<li><a href="table-basic.html"><span class="text"> Basic</span></a></li>
											<li><a href="table-advanced.html"><span class="text"> Advanced</span></a></li>
											<li><a href="table-responsive.html"><span class="text"> Responsive</span></a></li>
											<li><a href="table-editable.html"><span class="text"> Editable</span></a></li>
										</ul>
									</li>
									<li class="nav-parent">
										<a>
											<i class="fa fa-random" aria-hidden="true"></i><span>Visual Chart</span>
										</a>
										<ul class="nav nav-children">
											<li><a href="chart-flot.html"><span class="text"> Flot Chart</span></a></li>
											<li><a href="chart-xchart.html"><span class="text"> xChart</span></a></li>
											<li><a href="chart-other.html"><span class="text"> Other</span></a></li>
										</ul>
									</li>
									<li>
										<a href="widgets.html">
											<i class="fa fa-life-bouy" aria-hidden="true"></i><span>Widgets</span>
										</a>
									</li>
									<li>
										<a href="gallery.html">
											<i class="fa fa-picture-o" aria-hidden="true"></i><span>Gallery</span>
										</a>
									</li>
									<li>
										<a href="calendar.html">
											<i class="fa fa-calendar" aria-hidden="true"></i><span>Calendar</span>
										</a>
									</li>
									<li class="nav-parent">
										<a>
											<i class="fa fa-map-marker" aria-hidden="true"></i><span>Maps</span>
										</a>
										<ul class="nav nav-children">
											<li><a href="map-basic.html"><span class="text"> Basic</span></a></li>
											<li><a href="map-vector.html"><span class="text"> Vector</span></a></li>
										</ul>
									</li>
									<li>
										<a href="typography.html">
											<i class="fa fa-font" aria-hidden="true"></i><span>Typography</span>
										</a>
									</li>
									<li class="nav-parent">
										<a>
											<i class="fa fa-bolt" aria-hidden="true"></i><span>Icons</span>
										</a>
										<ul class="nav nav-children">
											<li><a href="icons-font-awesome.html"><span class="text"> Font Awesome</span></a></li>
											<li><a href="icons-weathericons.html"><span class="text"> Weather Icons</span></a></li>
											<li><a href="icons-glyphicons.html"><span class="text"> Glyphicons</span></a></li>
										</ul>
									</li>
								</ul>
							</nav>
						</div>
						<!-- End Sidebar Menu-->
					</div>
					<!-- Sidebar Footer-->
					<div class="sidebar-footer">
						<div class="small-chart-visits">
							<div class="small-chart" id="sparklineLineVisits"></div>
							<div class="small-chart-info">
								<label>New Visits</label>
								<strong>70,79%</strong>
							</div>
							<script type="text/javascript">
								var sparklineLineVisitsData = [15, 16, 17, 19, 15, 25, 23, 35, 29, 15, 30, 45];
							</script>
						</div>
						<ul class="sidebar-terms bk-margin-top-10">
							<li><a href="#">Terms</a></li>
							<li><a href="#">Privacy</a></li>
							<li><a href="#">Help</a></li>
							<li><a href="#">About</a></li>
						</ul>
					</div>
					<!-- End Sidebar Footer-->
				</div>
				<!-- End Sidebar -->

				<!-- Main Page -->
				<div class="main">
					<div class="col-lg-1 col-md-1 col-sm-1 col-xs-12"></div>
					<div class="col-lg-3 col-md-3 col-sm-3 col-xs-12">
						<div class="row mailbox">
							<div class="panel">
								<div class="panel-body bk-bg-very-light-gray mailbox-menu">
									<div class="panel-group" id="accordion2">
											<div class="panel panel-accordion">
												<div class="panel-heading bk-bg-primary">
													<h4 class="panel-title">
														<a class="accordion-toggle collapsed" data-toggle="collapse" data-parent="#accordion2" href="#collapse2One">
															<i class="fa fa-star"></i> 客观题
														</a>
													</h4>
												</div>
												<div id="collapse2One" class="accordion-body collapse" style="height: 0px;">
													<div class="panel-body" id="myindex">
													</div>
												</div>
											</div>
											<div class="panel panel-accordion panel-accordion-primary">
												<div class="panel-heading bk-bg-primary">
													<h4 class="panel-title">
														<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapse2Two">
															<i class="fa fa-cogs"></i> 主观题
														</a>
													</h4>
												</div>
												<div id="collapse2Two" class="accordion-body collapse in" style="">
													<div class="panel-body" id="yourindex">
													</div>
												</div>
											</div>
									</div>
									
									<div class="row" style="margin-top: 40px;">
										<label class="control-label"></label>
										<strong class="bk-fg-primary" style="font-size: 18px;margin-top: 5px;">
											<div class="point point-success point-lg"></div>倒计时：<span id="hour"></span>时<span id="minutes"></span>分<span id="seconds"></span>秒
										</strong>
									</div>
									<div class="row" style="margin-top: 40px;">
										<label class="control-label"></label>
										<strong class=" bk-fg-primary" style="font-size: 18px;margin-top: 5px;">
											<div class="point point-success point-lg"></div>试卷名：<span id="textname"></span>
										</strong>
									</div>
									<div class="row" style="margin-top: 40px;">
										<label class="control-label"></label>
										<strong class=" bk-fg-primary" style="font-size: 18px;margin-top: 5px;">
											<div class="point point-success point-lg"></div>答题人：<span th:text="${session.user.nickname}"></span>
										</strong>
									</div>
									<hr>
									<div class="row" style="margin-top: 30px;">
										<div class="col-lg-2 col-md-2 col-sm-2 col-xs-12"></div>
										<div class="col-lg-8 col-md-8 col-sm-8 col-xs-12">
											<div class="row">
												<button type="button" id="beforequestion" class="bk-margin-5 btn btn-primary">上一题</button>
												<button type="button" id="nextquestion" class="bk-margin-5 btn btn-primary">下一题</button>
												<button type="button" id="sumitquestion" class="bk-margin-5 btn btn-primary">提交</button>
											</div>
										</div>
										<div class="col-lg-2 col-md-2 col-sm-2 col-xs-12"></div>
									</div>
								</div>

							</div>
						</div>

					</div>
					<div class="col-lg-7 col-md-7 col-sm-7 col-xs-12">
						<div class="row" id="allquestion">
						</div>
					</div>
					<div class="col-lg-1 col-md-1 col-sm-1 col-xs-12"></div>
				</div>
			</div>
			<!--/container-->


			<div class="clearfix"></div>


			<!-- start: JavaScript-->

			<!-- Vendor JS-->
			<script th:src="@{static/assets/vendor/js/jquery.min.js}"></script>
			<script th:src="@{static/assets/vendor/js/jquery-2.1.1.min.js}"></script>
			<script th:src="@{static/assets/vendor/js/jquery-migrate-1.2.1.min.js}"></script>
			<script th:src="@{static/assets/vendor/bootstrap/js/bootstrap.min.js}"></script>
			<script th:src="@{static/assets/vendor/skycons/js/skycons.js}"></script>
			<script th:src="@{static/assets/vendor/js/pace.min.js}"></script>

			<!-- Plugins JS-->
			<script th:src="@{static/assets/plugins/jquery-ui/js/jquery-ui-1.10.4.min.js}"></script>
			<script th:src="@{static/assets/plugins/moment/js/moment.min.js}"></script>
			<script th:src="@{static/assets/plugins/sparkline/js/jquery.sparkline.min.js}"></script>

			<!-- Theme JS -->
			<script th:src="@{static/assets/js/jquery.mmenu.min.js}"></script>
			<script th:src="@{static/assets/js/core.min.js}"></script>

			<!-- Pages JS -->
			<script th:src="@{static/assets/js/pages/pricing-tables.js}"></script>
			<script th:src="@{static/js/template.js}"></script>
			<script th:src="@{static/layer/layer.js}"></script>
			<script th:src="@{static/layer/extend/layer.ext.js}"></script>
			<!-- end: JavaScript-->
			<input type="text" id="nowtestid" th:value="${testid}" style="display: none;">

			<script th:src="@{static/js/template.js}"></script>
			<script th:src="@{static/layer/layer.js}"></script>
			<script th:src="@{static/layer/extend/layer.ext.js}"></script>
			<script src="http://pv.sohu.com/cityjson?ie=utf-8"></script>
			<script type="text/javascript">
				$(function() {
					$("#main-menu-toggle").click();
					$("#main-menu-toggle").html("");
				});
			</script>

	</body>
	<script type="application/javascript">
		var nowquestionpage = 0;
		var questionpage = 1;
		var count = 0;
		var time = 0;
		var mycount = 0;
		var hour = 0;
		var minutes = 0;
		var seconds = 0;
		var local = "";

		function GetJsonData(quesid, stuanswer) {
			var json = {
				"quesid": quesid,
				"stuanswer": stuanswer
			};
			return json;
		}

		function getanswer(i) {
			var result = "";
			if ($("[nowquestion=" + i + "]").find("input[value='A']").is(':checked')) {
				result = result + "A";
			}
			if ($("[nowquestion=" + i + "]").find("input[value='B']").is(':checked')) {
				result = result + "B";
			}
			if ($("[nowquestion=" + i + "]").find("input[value='C']").is(':checked')) {
				result = result + "C";
			}
			if ($("[nowquestion=" + i + "]").find("input[value='D']").is(':checked')) {
				result = result + "D";
			}
			if ($("[nowquestion=" + i + "]").find("[gettext]").val() == "") {
				result = result + $("[nowquestion=" + i + "]").find("[gettextarea]").val();
			} else {
				result = result + $("[nowquestion=" + i + "]").find("[gettext]").val();
			}
			return result;
		}

		function getsaveanswer(i) {
			var result = "";
			if ($("[nowquestion=" + i + "]").find("[gettext]").val() == "") {
				result = result + $("[nowquestion=" + i + "]").find("[gettextarea]").val();
			} else {
				result = result + $("[nowquestion=" + i + "]").find("[gettext]").val();
			}
			return result;
		}
		$(document).ready(function() {
			var testid = $("#nowtestid").val();
			$.ajax({
				type: 'post',
				url: 'gettestmsg',
				async: false,
				data: {
					testid: testid
				},
								success: function(e) {
									console.log(e);
									time = e.countdown;
									count = e.limitchanges;
									hour = Math.floor(time / 3600);
									minutes = Math.floor(time % 3600 / 60);
									seconds = time % 60;
									$("#hour").html(hour);
									$("#minutes").html(minutes);
									$("#seconds").html(seconds);
									$("#textname").html(e.testname);
									$.ajax({
										type:'post',
										url: 'getsavetime',
										async: false,
										data: {
											testid:testid
										},
										success: function(result) {
											if(result.state==0){
												console.log("xxx");
											}else{
												mycount = result.mycount;
												hour = result.hour;
												minutes = result.minutes;
												seconds = result.seconds;
												$("#hour").html(hour);
												$("#minutes").html(minutes);
												$("#seconds").html(seconds);
												console.log("hhh");
											}
											var interval = setInterval(function() {
												if (seconds == 0) {
													if (minutes == 0) {
														if (hour == 0) {
															$("#sumitquestion").click();
															clearInterval(interval);
															return ;
														} else {
															hour--;
															minutes = 59;
															seconds = 59;
															$("#hour").html(hour);
															$("#minutes").html(minutes);
															$("#seconds").html(seconds);
														}
													} else {
														minutes = minutes - 1;
														seconds = 59;
														$("#seconds").html(seconds);
														$("#minutes").html(minutes);
													}
												} else {
													seconds = seconds - 1;
													$("#seconds").html(seconds);
												}
												if(seconds%10==0){
													$.ajax({
														type:'post',
														url: 'savetime',
														async: false,
														data: {
															hour:hour,
															minutes:minutes,
															seconds:seconds,
															mycount:mycount,
															testid:testid
														},
														success: function(result) {
															
														}
													});
												}
												if(seconds%30==0){
													var quesdata =[];
													for(var i=1;i<=nowquestionpage;i++){
														if(getsaveanswer(i)!=""){
															quesdata.push(GetJsonData($("[nowquestion=" + i + "]").attr("question"),getsaveanswer(i)));
														}
													}
													console.log(quesdata);
													var answerlist = JSON.stringify(quesdata);
													console.log(quesdata);
													$.ajax({
														type:'post',
														url: 'savequestion',
														async: false,
														data: {
															testid:testid,
															answerlist:answerlist
														},
														success: function(result) {
															
														}
													});
													
												}
											}, 1000);
										}
									});
								}
			});

			$.ajax({
				type: 'post',
				url: 'getquestionandscore',
				async: false,
				data: {
					"testid": testid
				},
				success: function(result) {
					console.log(result);
					if(result.single.length>0){
						$("#myindex").append("<br><strong class=\"bk-fg-primary\" style=\"font-size: 18px;\">"+
											"<div class=\"point point-success point-lg\"></div>单选题"+
										"</strong><br>\"");
					}
					for (var i = 0; i < result.single.length; i++) {
						var singlecontent = template("singletemplate", result.single[i]);
						nowquestionpage++;
						$('#allquestion').append(singlecontent);
						$("[question=" + result.single[i].lq.quesid + "]").attr("nowquestion", nowquestionpage);
						$("[question=" + result.single[i].lq.quesid + "]").find("[checkischange]").attr("checkischange",
							nowquestionpage);
						$("[question=" + result.single[i].lq.quesid + "]").find("#textquestion").hide();
						$("[question=" + result.single[i].lq.quesid + "]").find("#jianquestion").hide();
						$("#myindex").append("<button toquestionfast=\"" + nowquestionpage +
							"\" class=\"bk-margin-5 btn btn-default btn-circle btn-lg\" type=\"button\">" +
							"<span>" + nowquestionpage + "</span></button>");
						if (nowquestionpage == 1) {} else {
							$("[question=" + result.single[i].lq.quesid + "]").hide();
						}

					}
					if(result.mul.length>0){
						$("#myindex").append("<br><strong class=\"bk-fg-primary\" style=\"font-size: 18px;\">"+
											"<div class=\"point point-success point-lg\"></div>多选题"+
										"</strong><br>\"");
					}
					for (var i = 0; i < result.mul.length; i++) {
						var mulcontent = template("singletemplate", result.mul[i]);
						nowquestionpage++;
						$('#allquestion').append(mulcontent);
						$("[question=" + result.mul[i].lq.quesid + "]").attr("nowquestion", nowquestionpage);
						$("[question=" + result.mul[i].lq.quesid + "]").find("[checkischange]").attr("checkischange",
							nowquestionpage);
						$("[question=" + result.mul[i].lq.quesid + "]").find("#textquestion").hide();
						$("[question=" + result.mul[i].lq.quesid + "]").find("#jianquestion").hide();
						$("#myindex").append("<button toquestionfast=\"" + nowquestionpage +
							"\" class=\"bk-margin-5 btn btn-default btn-circle btn-lg\" type=\"button\">" +
							"<span>" + nowquestionpage + "</span></button>");
						if (nowquestionpage == 1) {} else {
							$("[question=" + result.mul[i].lq.quesid + "]").hide();
						}

					}
					if(result.jud.length>0){
						$("#myindex").append("<br><strong class=\"bk-fg-primary\" style=\"font-size: 18px;\">"+
											"<div class=\"point point-success point-lg\"></div>判断题"+
										"</strong><br>\"");
					}
					for (var i = 0; i < result.jud.length; i++) {
						var judcontent = template("singletemplate", result.jud[i]);
						nowquestionpage++;
						$('#allquestion').append(judcontent);
						$("[question=" + result.jud[i].lq.quesid + "]").attr("nowquestion", nowquestionpage);
						$("[question=" + result.jud[i].lq.quesid + "]").find("[checkischange]").attr("checkischange",
							nowquestionpage);
						$("[question=" + result.jud[i].lq.quesid + "]").find("#textquestion").hide();
						$("[question=" + result.jud[i].lq.quesid + "]").find("#jianquestion").hide();
						$("[question=" + result.jud[i].lq.quesid + "]").find("#" + result.jud[i].lq.quesid + "_c").hide();
						$("[question=" + result.jud[i].lq.quesid + "]").find("#" + result.jud[i].lq.quesid + "_d").hide();
						$("#myindex").append("<button toquestionfast=\"" + nowquestionpage +
							"\" class=\"bk-margin-5 btn btn-default btn-circle btn-lg\" type=\"button\">" +
							"<span>" + nowquestionpage + "</span></button>");
						if (nowquestionpage == 1) {} else {
							$("[question=" + result.jud[i].lq.quesid + "]").hide();
						}

					}
					if(result.tian.length>0){
						$("#yourindex").append("<br><strong class=\"bk-fg-primary\" style=\"font-size: 18px;\">"+
											"<div class=\"point point-success point-lg\"></div>填空题"+
										"</strong><br>\"");
					}
					for (var i = 0; i < result.tian.length; i++) {
						var tiancontent = template("singletemplate", result.tian[i]);
						$('#allquestion').append(tiancontent);
						nowquestionpage++;
						$("[question=" + result.tian[i].lq.quesid + "]").attr("nowquestion", nowquestionpage);
						$("[question=" + result.tian[i].lq.quesid + "]").find("#jianquestion").hide();
						$("[question=" + result.tian[i].lq.quesid + "]").find("[checkischange]").attr("checkischange",
							nowquestionpage);
						$("[question=" + result.tian[i].lq.quesid + "]").find("#" + result.tian[i].lq.quesid + "_a").hide();
						$("[question=" + result.tian[i].lq.quesid + "]").find("#" + result.tian[i].lq.quesid + "_b").hide();
						$("[question=" + result.tian[i].lq.quesid + "]").find("#" + result.tian[i].lq.quesid + "_c").hide();
						$("[question=" + result.tian[i].lq.quesid + "]").find("#" + result.tian[i].lq.quesid + "_d").hide();
						$("#yourindex").append("<button toquestionfast=\"" + nowquestionpage +
							"\" class=\"bk-margin-5 btn btn-default btn-circle btn-lg\" type=\"button\">" +
							"<span>" + nowquestionpage + "</span></button>");
						if (nowquestionpage == 1) {} else {
							$("[question=" + result.tian[i].lq.quesid + "]").hide();
						}

					}
					if(result.jian.length>0){
						$("#yourindex").append("<br><strong class=\"bk-fg-primary\" style=\"font-size: 18px;\">"+
											"<div class=\"point point-success point-lg\"></div>简答题"+
										"</strong><br>\"");
					}
					for (var i = 0; i < result.jian.length; i++) {
						var jiancontent = template("singletemplate", result.jian[i]);
						$('#allquestion').append(jiancontent);
						nowquestionpage++;
						$("[question=" + result.jian[i].lq.quesid + "]").attr("nowquestion", nowquestionpage);
						$("[question=" + result.jian[i].lq.quesid + "]").find("#textquestion").hide();
						$("[question=" + result.jian[i].lq.quesid + "]").find("[checkischange]").attr("checkischange",
							nowquestionpage);
						$("[question=" + result.jian[i].lq.quesid + "]").find("#" + result.jian[i].lq.quesid + "_a").hide();
						$("[question=" + result.jian[i].lq.quesid + "]").find("#" + result.jian[i].lq.quesid + "_b").hide();
						$("[question=" + result.jian[i].lq.quesid + "]").find("#" + result.jian[i].lq.quesid + "_c").hide();
						$("[question=" + result.jian[i].lq.quesid + "]").find("#" + result.jian[i].lq.quesid + "_d").hide();
						$("#yourindex").append("<button toquestionfast=\"" + nowquestionpage +
							"\" class=\"bk-margin-5 btn btn-default btn-circle btn-lg\" type=\"button\">" +
							"<span>" + nowquestionpage + "</span></button>");
						if (nowquestionpage == 1) {} else {
							$("[question=" + result.jian[i].lq.quesid + "]").hide();
						}

					}
					$("[toquestionfast=" + questionpage + "]").addClass("btn-warning");
					$.ajax({
						type: 'post',
						url: 'getsaveques',
						async: false,
						data: {
							testid: testid
						},
						success: function(result) {
							console.log("让我seesee");
							console.log(result);
							for (var i = 0; i < result.length; i++) {
								//alert(result[i].stuanswer);
								$("[question=" + result[i].quesid + "]").find("[gettext]").val(result[i].stuanswer);
								$("[question=" + result[i].quesid + "]").find("[gettextarea]").val(result[i].stuanswer);
							}

						}
					});
				}
			});
		});
		
		$("#beforequestion").click(function() {
			if (questionpage == 1) {
				return;
			} else {
				questionpage--;
				$("[question]").hide();
				$("[nowquestion=" + questionpage + "]").show();
				$("[toquestionfast=" + (questionpage+1) + "]").removeClass("btn-warning");
				$("[toquestionfast=" + questionpage + "]").addClass("btn-warning");
			}
		});
		$("#nextquestion").click(function() {
			if (questionpage == nowquestionpage) {
				return;
			} else {
				questionpage++;
				$("[question]").hide();
				$("[nowquestion=" + questionpage + "]").show();
				$("[toquestionfast=" + (questionpage-1) + "]").removeClass("btn-warning");
				$("[toquestionfast=" + questionpage + "]").addClass("btn-warning");
			}
		});

		$("[toquestionfast]").live('click', function() {
			$("[question]").hide();
			$("[toquestionfast=" + questionpage + "]").removeClass("btn-warning");
			var i = $(this).find("span").html();
			questionpage = i;
			$("[nowquestion=" + i + "]").show();
			$("[toquestionfast=" + questionpage + "]").addClass("btn-warning");
		});


		$("[checkischange]").live('blur', function() {
			var i = $(this).attr("checkischange");
			$("[toquestionfast=" + i + "]").removeClass("btn-default");
			$("[toquestionfast=" + i + "]").addClass("btn-success");
		});

		$("#sumitquestion").click(function() {
			var testid = $("#nowtestid").val();
			var ipaddress = returnCitySN["cip"];
			var brower = myBrowser();
			var os = detectOS();
			var data = [];
			for (var i = 1; i <= nowquestionpage; i++) {
				data.push(GetJsonData($("[nowquestion=" + i + "]").attr("question"), getanswer(i)));
			}
			console.log(data);
			var answerlist = JSON.stringify(data);
			var lessdu = hour * 3600 + minutes * 60 + seconds;
			$.ajax({
				type: 'post',
				url: 'subimtpaper',
				async: false,
				data: {
					testid: testid,
					ipaddress: ipaddress,
					brower: brower,
					os: os,
					mycount: mycount,
					lessdu: lessdu,
					local: local,
					answerlist: answerlist
				},
				success: function(result) {
					layer.msg('提交成功', {time: 2000, icon:6});
					setTimeout(function(){
					        window.location.href="getinpeoplehome";
					},1000);
				}
			});
		});



		function myBrowser() {
			var userAgent = navigator.userAgent; //取得浏览器的userAgent字符串
			var isOpera = userAgent.indexOf("Opera") > -1; //判断是否Opera浏览器
			var isIE = userAgent.indexOf("compatible") > -1 &&
				userAgent.indexOf("MSIE") > -1 && !isOpera; //判断是否IE浏览器
			var isEdge = userAgent.indexOf("Edge") > -1; //判断是否IE的Edge浏览器
			var isFF = userAgent.indexOf("Firefox") > -1; //判断是否Firefox浏览器
			var isSafari = userAgent.indexOf("Safari") > -1 &&
				userAgent.indexOf("Chrome") == -1; //判断是否Safari浏览器
			var isChrome = userAgent.indexOf("Chrome") > -1 &&
				userAgent.indexOf("Safari") > -1; //判断Chrome浏览器

			if (isIE) {
				var reIE = new RegExp("MSIE (\\d+\\.\\d+);");
				reIE.test(userAgent);
				var fIEVersion = parseFloat(RegExp["$1"]);
				if (fIEVersion == 7) {
					return "IE7";
				} else if (fIEVersion == 8) {
					return "IE8";
				} else if (fIEVersion == 9) {
					return "IE9";
				} else if (fIEVersion == 10) {
					return "IE10";
				} else if (fIEVersion == 11) {
					return "IE11";
				} else {
					return "0";
				} //IE版本过低
				return "IE";
			}
			if (isOpera) {
				return "Opera";
			}
			if (isEdge) {
				return "Edge";
			}
			if (isFF) {
				return "FF";
			}
			if (isSafari) {
				return "Safari";
			}
			if (isChrome) {
				return "Chrome";
			}

		}


		function detectOS() {
			var sUserAgent = navigator.userAgent.toLowerCase();
			var isWin = (navigator.platform == "Win32") || (navigator.platform == "Win64") || (navigator.platform == "wow64");
			var isMac = (navigator.platform == "Mac68K") || (navigator.platform == "MacPPC") || (navigator.platform ==
				"Macintosh") || (navigator.platform == "MacIntel");
			if (isMac) return "Mac";
			var isUnix = (navigator.platform == "X11") && !isWin && !isMac;
			if (isUnix) return "Unix";
			var isLinux = (String(navigator.platform).indexOf("Linux") > -1);
			var bIsAndroid = sUserAgent.toLowerCase().match(/android/i) == "android";
			if (isLinux) {
				if (bIsAndroid) return "Android";
				else return "Linux";
			}
			if (isWin) {
				var isWin2K = sUserAgent.indexOf("Windows nt 5.0") > -1 || sUserAgent.indexOf("Windows 2000") > -1;
				if (isWin2K) return "Win2000";
				var isWinXP = sUserAgent.indexOf("Windows nt 5.1") > -1 || sUserAgent.indexOf("Windows XP") > -1
				sUserAgent.indexOf("Windows XP") > -1;
				if (isWinXP) return "WinXP";
				var isWin2003 = sUserAgent.indexOf("Windows nt 5.2") > -1 || sUserAgent.indexOf("Windows 2003") > -1;
				if (isWin2003) return "Win2003";
				var isWinVista = sUserAgent.indexOf("Windows nt 6.0") > -1 || sUserAgent.indexOf("Windows Vista") > -1;
				if (isWinVista) return "WinVista";
				var isWin7 = sUserAgent.indexOf("Windows nt 6.1") > -1 || sUserAgent.indexOf("Windows 7") > -1;
				if (isWin7) return "Win7";
				var isWin8 = sUserAgent.indexOf("windows nt 6.2") > -1 || sUserAgent.indexOf("Windows 8") > -1;
				if (isWin8) return "Win8";
				var isWin10 = sUserAgent.indexOf("windows nt 10.0") > -1 || sUserAgent.indexOf("Windows 10") > -1;
				if (isWin10) return "Win10";
			}
			return "other";
		}

		$.ajax({
			//2bcfab7f32b3d497caa50b24652beaba
			type: 'get',
			url: "https://restapi.amap.com/v3/ip?ip=" + returnCitySN["cip"] +
				"&output=json&key=2bcfab7f32b3d497caa50b24652beaba",
			async: false,
			success: function(result) {
				var a = "";
				local = result.province + result.city;
			}
		});

				document.addEventListener('visibilitychange', function() { //浏览器切换事件
					if (document.visibilityState == 'hidden') { //状态判断
						mycount++;
						if (mycount > count) {
							$("#sumitquestion").click();
						} else {
							layer.alert("禁止切出网页,已切出" + mycount + "次,"+count+"次后自动提交");
						}
					} else {}
				});
	</script>
	<!--简答题-->
	<script type="text/html" id="singletemplate">
		<div class=" col-md-12 panel panel-info" question="{{lq.quesid}}" nowquestion="" style="padding-top: 20px;">
								<div class="panel-heading bk-bg-primary" >
									<div class="row">
										<div class="text-left bk-vcenter">
											<span class="bk-margin-off" style="font-size: 20px; padding-left: 10px;">题目（{{ls.quesscore}}分）标签：{{lq.tag}} &nbsp;&nbsp;难度：{{lq.difficulty}}</span>
										</div>
									</div>
								</div>
							<div class="panel-body" style="font-size: 20px;">题目：{{lq.quescontext}}</div>
								<div class="header" style="margin-top: 5px; margin-bottom:10px; ">	
									<div class="panel-body" style="padding-top: 10px; ">
										<span style="font-size: 20px;">答案：</span>
										<div class="form-group">
											<div>
												<div class="input-group" id="{{lq.quesid}}_a" style="margin-top: 30px;">
													<span class="input-group-addon"><input type="checkbox" name="{{lq.quesid}}_radios1" value="A" checkischange=""></span>
													<label class="form-control" style="font-size: 20px;">{{lq.a}}</label>
												</div>
												<div class="input-group" id="{{lq.quesid}}_b" style="margin-top: 30px;">
													<span class="input-group-addon"><input type="checkbox"  name="{{lq.quesid}}_radios2" value="B" checkischange=""></span>
													<label class="form-control" style="font-size: 20px;">{{lq.b}}</label>
												</div>
												<div class="input-group" id="{{lq.quesid}}_c" style="margin-top: 30px;">
													<span class="input-group-addon"><input type="checkbox"  name="{{lq.quesid}}_radios3" value="C" checkischange=""></span>
													<label class="form-control" style="font-size: 20px;">{{lq.c}}</label>
												</div>
												<div class="input-group" id="{{lq.quesid}}_d" style="margin-top: 30px;">
													<span class="input-group-addon"><input type="checkbox"  name="{{lq.quesid}}_radios4" value="D" checkischange=""></span>
													<label class="form-control" style="font-size: 20px;">{{lq.d}}</label>
												</div>
												<div class="input-group col-md-12" style="margin-top: 30px;" id="textquestion">
												<input style="font-size: 20px;" type="text" id="{{lq.quesid}}_text" name="text-input" class="form-control" gettext="" placeholder="Text" checkischange="">
												</div>
												<div class="input-group col-md-12" style="margin-top: 30px;" id="jianquestion">
												<textarea id="{{lq.quesid}}_textarea" style="resize: none;font-size: 20px;"name="textarea-input" gettextarea="" rows="6" class="form-control" placeholder="Content.." checkischange=""></textarea>
												</div>
											</div>
										</div>
								   </div>																										
								</div>
							</div>			
	</script>
</html>
